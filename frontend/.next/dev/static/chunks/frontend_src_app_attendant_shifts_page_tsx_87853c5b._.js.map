{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/petrol_station/frontend/src/app/attendant/shifts/page.tsx"],"sourcesContent":["// app/attendant-shifts/page.tsx\n\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useAuth } from \"@/context/auth-context\";\nimport { Button, Card } from \"@/components/ui\"; // example UI components\n\ninterface Shift {\n  id: number;\n  shiftType: string;\n  scheduledDate: string;\n  scheduledStartTime: string;\n  scheduledEndTime: string;\n  status: string;\n  assignedPump?: string;\n  notes?: string;\n}\n\nexport default function AttendantShiftsPage() {\n  const { user, token } = useAuth();\n  const [shifts, setShifts] = useState<Shift[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (!token) return; // prevent fetching if not logged in\n\n    const fetchShifts = async () => {\n      try {\n        const res = await fetch(\"http://localhost:5000/api/shifts/my-shifts?upcoming=true\", {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        });\n\n        if (!res.ok) throw new Error(\"Failed to fetch shifts\");\n\n        const data = await res.json();\n        setShifts(data);\n      } catch (err) {\n        console.error(err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchShifts();\n  }, [token]);\n\n  const handleStartShift = async (shiftId: number) => {\n    try {\n      const res = await fetch(`http://localhost:5000/api/shifts/start/${shiftId}`, {\n        method: \"PUT\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      if (!res.ok) throw new Error(\"Failed to start shift\");\n      const updated = await res.json();\n      setShifts((prev) =>\n        prev.map((s) => (s.id === shiftId ? { ...s, status: \"IN_PROGRESS\" } : s))\n      );\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleEndShift = async (shiftId: number) => {\n    try {\n      const res = await fetch(`http://localhost:5000/api/shifts/end/${shiftId}`, {\n        method: \"PUT\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      });\n\n      if (!res.ok) throw new Error(\"Failed to end shift\");\n      const updated = await res.json();\n      setShifts((prev) =>\n        prev.map((s) => (s.id === shiftId ? { ...s, status: \"COMPLETED\" } : s))\n      );\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  if (loading) return <p>Loading shifts...</p>;\n  if (!shifts.length) return <p>No shifts found</p>;\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 p-4\">\n      {shifts.map((shift) => (\n        <Card key={shift.id} className=\"p-4\">\n          <h3 className=\"font-bold\">{shift.shiftType} Shift</h3>\n          <p>Date: {shift.scheduledDate}</p>\n          <p>\n            Time: {shift.scheduledStartTime} - {shift.scheduledEndTime}\n          </p>\n          <p>Status: {shift.status}</p>\n          <p>Pump: {shift.assignedPump || \"N/A\"}</p>\n\n          {shift.status === \"SCHEDULED\" && (\n            <Button onClick={() => handleStartShift(shift.id)}>Start Shift</Button>\n          )}\n          {shift.status === \"IN_PROGRESS\" && (\n            <Button onClick={() => handleEndShift(shift.id)}>End Shift</Button>\n          )}\n        </Card>\n      ))}\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;AAGhC;AACA;;;;;;;;AAHA;;;;AAiBe,SAAS;;IACtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,IAAA,4JAAO;IAC/B,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,qLAAQ,EAAU,EAAE;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,qLAAQ,EAAC;IAEvC,IAAA,sLAAS;yCAAC;YACR,IAAI,CAAC,OAAO,QAAQ,oCAAoC;YAExD,MAAM;6DAAc;oBAClB,IAAI;wBACF,MAAM,MAAM,MAAM,MAAM,4DAA4D;4BAClF,SAAS;gCACP,eAAe,CAAC,OAAO,EAAE,OAAO;4BAClC;wBACF;wBAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;wBAE7B,MAAM,OAAO,MAAM,IAAI,IAAI;wBAC3B,UAAU;oBACZ,EAAE,OAAO,KAAK;wBACZ,QAAQ,KAAK,CAAC;oBAChB,SAAU;wBACR,WAAW;oBACb;gBACF;;YAEA;QACF;wCAAG;QAAC;KAAM;IAEV,MAAM,mBAAmB,OAAO;QAC9B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,uCAAuC,EAAE,SAAS,EAAE;gBAC3E,QAAQ;gBACR,SAAS;oBACP,eAAe,CAAC,OAAO,EAAE,OAAO;gBAClC;YACF;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;YAC7B,MAAM,UAAU,MAAM,IAAI,IAAI;YAC9B,UAAU,CAAC,OACT,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,UAAU;wBAAE,GAAG,CAAC;wBAAE,QAAQ;oBAAc,IAAI;QAE1E,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;QAChB;IACF;IAEA,MAAM,iBAAiB,OAAO;QAC5B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,qCAAqC,EAAE,SAAS,EAAE;gBACzE,QAAQ;gBACR,SAAS;oBACP,eAAe,CAAC,OAAO,EAAE,OAAO;gBAClC;YACF;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;YAC7B,MAAM,UAAU,MAAM,IAAI,IAAI;YAC9B,UAAU,CAAC,OACT,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,UAAU;wBAAE,GAAG,CAAC;wBAAE,QAAQ;oBAAY,IAAI;QAExE,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC;QAChB;IACF;IAEA,IAAI,SAAS,qBAAO,yMAAC;kBAAE;;;;;;IACvB,IAAI,CAAC,OAAO,MAAM,EAAE,qBAAO,yMAAC;kBAAE;;;;;;IAE9B,qBACE,yMAAC;QAAI,WAAU;kBACZ,OAAO,GAAG,CAAC,CAAC,sBACX,yMAAC;gBAAoB,WAAU;;kCAC7B,yMAAC;wBAAG,WAAU;;4BAAa,MAAM,SAAS;4BAAC;;;;;;;kCAC3C,yMAAC;;4BAAE;4BAAO,MAAM,aAAa;;;;;;;kCAC7B,yMAAC;;4BAAE;4BACM,MAAM,kBAAkB;4BAAC;4BAAI,MAAM,gBAAgB;;;;;;;kCAE5D,yMAAC;;4BAAE;4BAAS,MAAM,MAAM;;;;;;;kCACxB,yMAAC;;4BAAE;4BAAO,MAAM,YAAY,IAAI;;;;;;;oBAE/B,MAAM,MAAM,KAAK,6BAChB,yMAAC;wBAAO,SAAS,IAAM,iBAAiB,MAAM,EAAE;kCAAG;;;;;;oBAEpD,MAAM,MAAM,KAAK,+BAChB,yMAAC;wBAAO,SAAS,IAAM,eAAe,MAAM,EAAE;kCAAG;;;;;;;eAb1C,MAAM,EAAE;;;;;;;;;;AAmB3B;GA7FwB;;QACE,4JAAO;;;KADT","debugId":null}}]
}